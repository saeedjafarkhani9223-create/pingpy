<!DOCTYPE html>
<html lang="fa">
<head>
<link rel="manifest" href="manifest.json">
<meta charset="UTF-8">
<title>Pingpy – دستیار حقوقی</title>
<style>
body{margin:0;font-family:sans-serif;background:#0f172a;color:#e5e7eb;height:100vh;display:flex;justify-content:center;align-items:center}
.app{width:100%;max-width:600px;height:90vh;background:#020617;border-radius:12px;display:flex;flex-direction:column}
header{padding:12px;text-align:center;border-bottom:1px solid #1e293b}
.chat{flex:1;padding:12px;overflow:auto}
.msg{margin-bottom:10px;line-height:1.6}
.user{text-align:right;color:#38bdf8}
.bot{text-align:left;color:#facc15}
footer{display:flex;border-top:1px solid #1e293b}
input{flex:1;padding:12px;background:#020617;color:#fff;border:none;outline:none}
button{background:#2563eb;color:#fff;border:none;padding:0 20px}
</style>
</head>
<body>

<div class="app">
  <header>Pingpy | دستیار حقوقی</header>
  <div class="chat" id="chat"></div>
  <footer>
    <input id="q" placeholder="سؤال حقوقی بنویس..." />
    <button onclick="ask()">ارسال</button>
  </footer>
</div>


<script>
async function ask() {
  const input = document.getElementById("q");
  const chat = document.getElementById("chat");
  const question = input.value.trim();
  if (!question) return;

  chat.innerHTML += `<div class="msg user">${question}</div>`;
  input.value = "";

  const botMsg = document.createElement("div");
  botMsg.className = "msg bot";
  botMsg.innerText = "در حال تحلیل...";
  chat.appendChild(botMsg);
  chat.scrollTop = chat.scrollHeight;

  try {
    const res = await fetch(
      "https://gentle-lab-da89.saeedjafarkhani9223.workers.dev",
      {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          question: question,
          history: []
        })
      }
    );

    const data = await res.json();
    botMsg.innerText = data.answer || "پاسخی دریافت نشد";
  } catch (e) {
    botMsg.innerText = "❌ خطا در ارتباط با سامانه تحلیل حقوقی";
  }

  chat.scrollTop = chat.scrollHeight;
}
</script>



</body>
</html>
